/*!
* Tim
*   github.com/premasagar/tim
*
*//*
    A tiny, secure JavaScript micro-templating script.
*/
var tim=function F(A){function B(){p=RegExp(j.start+"\\s*("+j.path+")\\s*"+j.end,"gi")}function C(a){var b;if(a){for(b in a)if(a.hasOwnProperty(b))j[b]=a[b];B()}return j}function t(a,b){var c;switch(typeof a){case "string":if(b===q)return r[a]||"";else if(b===false)delete r[a];else r[a]=b;break;case "object":for(c in a)a.hasOwnProperty(c)&&t(c,a[c]);break;case "boolean":a||(r={})}return r}function G(a,b){return a[1]-b[1]}function v(a,b,c){var e=w[a];e||(e=w[a]=[]);e.push([b,c||0]);e.sort(G);return b}
function l(a,b){var c=w[a],e,d,f,g;if(c){e=[b];d=2;for(f=arguments.length;d<f;d++)e.push(arguments[d]);d=0;for(f=c.length;d<f;d++){e[0]=b;g=c[d][0].apply(null,e);if(b!==q&&g!==q)b=g;if(x){x=false;break}}}return b}function D(a,b){return(typeof b==="function"?v:l).apply(null,arguments)}function n(a,b){var c;if(!E){E=1;l("init")}a=l("templateBefore",a);if(a.indexOf(j.start)<0)if(c=t(a))a=c;if((a=l("template",a))&&b!==q){c=a;for(var e,d,f,g,i,k,y,o,s,m,z;(e=p.exec(c))!==null;){d=e[1];f=l("token",d,b,
c);g=e.index;e=p.lastIndex;g=c.slice(0,g);i=c.slice(e);if(typeof f==="function")f=f.call(b);if(typeof f!=="boolean"&&typeof f!=="object")c=g+f+i;else{k="";y=j.start+"/"+d+j.end;o=i.indexOf(y);if(o>=0){i=i.slice(0,o);if(typeof f==="boolean")k=f?i:"";else{for(s in f)if(f.hasOwnProperty(s)){p.lastIndex=0;m={d:s,c:f[s]};o=f[s];var u=void 0;for(u in o)if(o.hasOwnProperty(u))m[u]=o[u];m=m;m=l("loopData",m,z,d);z=n(i,m);k+=l("loop",z,d,m)}k=l("loopEnd",k,d,m)}c=g+k+c.slice(e+i.length+y.length)}else throw"tim: '"+
d+"' not closed";}p.lastIndex=0}a=c}return a=l("templateAfter",a)}var j={start:"{{",end:"}}",path:"[a-z0-9_][\\.a-z0-9_]*"},r={},w={},x,p,E,q;A?C(A):B();D.stop=function(){x=true};n.f=C;n.g=t;n.e=F;n.filter=D;v("token",function(a,b,c){a=a.split(".");var e=a.length;b=b;for(var d=0;d<e;d++){b=b[a[d]];if(b===q)throw"tim: '"+a[d]+"' not found"+(d?" in "+c:"");if(d===e-1)return b}});if(window&&window.document){n.b=function(a){a=a||{};var b=a.type||j.type||"text/tim";a=a.a||j.a||"class";var c=window.document,
e=!!c.querySelectorAll;c=e?c.querySelectorAll("script[type='"+b+"']"):c.getElementsByTagName("script");for(var d=0,f=c.length,g,i,k={};d<f;d++){g=c[d];if((i=g.getAttribute(a))&&e||c[g.type]===b)k[i]=g.innerHTML}t(k);return k};v("init",function(){n.b()})}return n}();
